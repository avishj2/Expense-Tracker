<div class="expense-list">
  <h2>Expense List</h2>

  <!-- Filters -->
  <div class="filter-controls">
    <div class="filter-group">
      <label for="fromDate">From:</label>
      <input id="fromDate" type="date" [(ngModel)]="fromDate" />
    </div>

    <div class="filter-group">
      <label for="toDate">To:</label>
      <input id="toDate" type="date" [(ngModel)]="toDate" />
    </div>

    <div class="filter-group">
      <label for="searchQuery">Search:</label>
      <input
        id="searchQuery"
        type="text"
        [(ngModel)]="searchQuery"
        placeholder="Search expenses..."
      />
    </div>

    <div class="filter-actions">
      <button (click)="filterExpenses()" class="search-btn">Search</button>
      <button (click)="resetFilters()" class="reset-btn">Reset</button>
    </div>
  </div>

  <!-- Excel Export -->
  <div class="export-button">
    <button (click)="exportToExcel()">â¬‡ Download Excel</button>
  </div>

  <!-- Expense Table -->
  <table>
    <thead>
      <tr>
        <th>Description</th>
        <th>Category</th>
        <th (click)="sortExpenses('amount')">Amount (Rs.) ðŸ”¼</th>
        <th (click)="sortExpenses('date')">Date ðŸ”¼</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="let expense of paginatedExpenses"
        [class.editing-row]="editingExpenseId === expense.id"
      >
        <!-- Description -->
        <td>
          <input
            *ngIf="editingExpenseId === expense.id"
            [(ngModel)]="editableExpense.description"
            placeholder="Description"
          />
          <span *ngIf="editingExpenseId !== expense.id">
            {{ expense.description }}
          </span>
        </td>

        <!-- Category -->
        <td>
          <select
            *ngIf="editingExpenseId === expense.id"
            [(ngModel)]="editableExpense.category"
          >
            <option value="Food">Food</option>
            <option value="Travel">Travel</option>
            <option value="Bills">Bills</option>
            <option value="Entertainment">Entertainment</option>
            <option value="Others">Others</option>
          </select>
          <span *ngIf="editingExpenseId !== expense.id">
            {{ expense.category }}
          </span>
        </td>

        <!-- Amount -->
        <td>
          <input
            type="number"
            *ngIf="editingExpenseId === expense.id"
            [(ngModel)]="editableExpense.amount"
            placeholder="Amount"
          />
          <span *ngIf="editingExpenseId !== expense.id">
            {{ expense.amount | currency }}
          </span>
        </td>

        <!-- Date -->
        <td>
          <input
            type="date"
            *ngIf="editingExpenseId === expense.id"
            [(ngModel)]="editableExpense.date"
          />
          <span *ngIf="editingExpenseId !== expense.id">
            {{ expense.date }}
          </span>
        </td>

        <!-- Actions -->
        <td>
          <button
            class="save-btn"
            *ngIf="editingExpenseId !== expense.id"
            (click)="startEditing(expense)"
          >
            Edit
          </button>
          <button
            class="save-btn"
            *ngIf="editingExpenseId === expense.id"
            (click)="saveEdit()"
          >
            Save
          </button>
          <button
            class="cancel-btn"
            *ngIf="editingExpenseId === expense.id"
            (click)="cancelEdit()"
          >
            Cancel
          </button>
          <button
            class="delete-btn"
            *ngIf="editingExpenseId !== expense.id"
            (click)="deleteExpense(expense.id)"
          >
            Delete
          </button>
        </td>
      </tr>
    </tbody>

    <tfoot>
      <tr>
        <td colspan="2"><strong>Total</strong></td>
        <td colspan="3">
          <strong>{{ calculateTotalExpense() | currency }}</strong>
        </td>
      </tr>
    </tfoot>
  </table>

  <!-- Pagination -->
  <div class="pagination">
    <button
      *ngFor="let page of [].constructor(totalPages); let i = index"
      [class.active]="currentPage === i + 1"
      (click)="goToPage(i + 1)"
    >
      {{ i + 1 }}
    </button>
  </div>
</div>
